<div *ngIf="postAlertBool"
     [class.alert-danger]="postAlertCode!=200"
     [class.alert-success]="postAlertCode==200"
     class="py-2 mt-2 w-auto text-center" id="post_alert">
    <span class="fa fa-bell mx-3"></span>
    {{postAlert}}
    <span (click)="dismissAlert()"
          class="fa fa-times fa-sm mx-3 my-auto cursor-pointer" id="alert_close"></span>
</div>
<div class="container mt-3">
    <div class="container mt-3">
        <div class="row">
            <div class="col-lg-6 col-md-12">
                <div class="row bg-transparent br-20 py-1">
                    <div class="col-md-12">
                        <a download="post_template.csv" href="files/post_template.csv">
                            <button id="downloads" class="btn btn-primary border-0 br-20 px-4" style="margin-bottom: 10px">
                                <!--<material-icon icon="get_app" class="mt-1"></material-icon>-->
                                <span class="fa fa-download mt-1"></span>
                                <span class="down-text">Download template</span>
                            </button>
                        </a>
                    </div>
                </div>
            </div>
            <csv-app></csv-app>
        </div>
    </div>

    <div class="row justify-content-start mt-3">
        <div class="col-md-10 col-sm-12 col-lg-5" id="create-table" style="margin-bottom: 20px">
            <div class="card shadow-c c-bordered bg-transparent {{appTheme['box-one']}} br-20">
                <div class="card-body mr-auto ml-auto">
                    <form action="#" novalidate>
                        <div class="form-group">
                            <div class="container mt-3 w-100">
                                <div class="form-group">
                                    <div class="row" style="margin-bottom: 40px">
                                        <!--<input (keyup.enter)="addPost()" [(ngModel)]="postMessage"
                                               class="nt-form-control w-75 ml-auto"
                                               (input)="getInputSelection(el)"
                                               (click)="getInputSelection(el)"
                                               (keyup)="getInputSelection(el)"
                                               id="message_box" placeholder="Write post message..."
                                               #el
                                               size="50" type="text" style="font-size: 17px !important;">-->
                                        <textarea name="message"
                                                  id="message_box"
                                                  cols="50" rows="1"
                                                  class="nt-form-control w-75 ml-auto br-20"
                                                  #el
                                                  (input)="getInputSelection(el)"
                                                  (click)="getInputSelection(el)"
                                                  (keyup)="getInputSelection(el)"
                                                  placeholder="Write post message..."
                                                  [(ngModel)]="postMessage"
                                                  style="font-size: 17px !important;">
                                            <!--(keyup.enter)="addPost()"-->
                                        </textarea>
                                        <!--<a type="button" class="btn-floating btn-comm waves-effect waves-light w-15 ml-auto my-auto" (click)="addPost()"
                                           *ngIf="!editKey && !isSending">
                                            <span class="fa fa-paper-plane nt-center text-white"></span>
                                        </a>-->
                                        <span (click)="addPost()"
                                              *ngIf="!editKey && !isSending"
                                              class="fa fa-paper-plane w-15 ml-auto my-auto text-default-six cursor-pointer">
                                        </span>
                                        <span *ngIf="isSending" class="w-15 ml-auto my-auto">
                                            <img src="img/mini-loader.gif" style="width: 20px; height: auto">
                                        </span>
                                        <span (click)="updatePost()"
                                              *ngIf="editKey && !isSending"
                                              class="fa fa-pencil w-15 ml-auto my-auto text-default-four cursor-pointer">
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group mt-4">
                            <ul class="nav">
                                <li class="nav-item mx-auto">
                                    <a class="c-link text-default-six" data-toggle="tab" href="#panel1" role="tab">
                                        <div id="pictures">
                                            <material-icon icon="image" class="b-icon p-1"></material-icon>
                                            <span class="pic-text">Upload image</span>
                                        </div>
                                    </a>
                                </li>
                                <li class="nav-item mx-auto">
                                    <a class="c-link text-danger" data-toggle="tab" href="#panel2" role="tab">
                                        <div id="emojis">
                                            <material-icon icon="tag_faces" class="b-icon p-1"></material-icon>
                                            <span class="emo-text">Emoji's</span>
                                        </div>
                                    </a>
                                </li>
                                <li class="nav-item mx-auto">
                                    <a class="c-link text-primary" data-toggle="tab" href="#panel3" role="tab">
                                        <div id="tags">
                                            <material-icon icon="tag" class="b-icon p-1"></material-icon>
                                            <span class="tag-text">Tags</span>
                                        </div>
                                    </a>
                                </li>
                                <li class="nav-item mx-auto">
                                    <a class="c-link text-default-one" data-toggle="tab" href="#panel3" role="tab">
                                        <div id="priority">
                                            <material-toggle [(checked)]="toggleState"></material-toggle>
                                            <span class="priority-text">Priority</span>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                            <!-- Tab panels -->
                            <div class="tab-content mt-3">
                                <!-- Panel 1 -->
                                <div class="tab-pane fade in show active position-relative" id="panel1" role="tabpanel" style="overflow-y: scroll !important;">
                                    <!--<div class="text-muted cursor-pointer text-center br-20 small" *ngIf="imgPaths.isEmpty">Click to + to add image</div>-->
                                    <!--<div class="row m-0 w-100">
                                        <div class="col-auto mx-auto py-2" *ngFor="let imgPath of imgPaths; let $i = index">
                                            <a target="_blank" href="{{imgPath}}" class="post-image img-center">
                                                <div class="row mx-0 w-100 my-2" *ngIf="imagesProgress[$i] != 100">
                                                    <div class="col-sm-10 mx-auto">
                                                        <div class="progress-div" style="width: {{imagesProgress[$i]}}%;"></div>
                                                    </div>
                                                </div>
                                                <img src="{{imgPath}}" alt="{{imgPath}}" width="120" class="img-fluid img-center br-20" [class.blur]="imagesProgress[$i] != 100">
                                            </a>
                                        </div>
                                    </div>-->
                                    <div class="m-0 p-2">
                                        <div class="card-columns">
                                            <div class="card bg-transparent p-2 border-0" *ngFor="let imgPath of imgPaths; let $i = index" style="border-radius: 10px">
                                                <a target="_blank" href="{{imgPath}}" class="post-image img-center">
                                                    <div class="row mx-0 w-100 my-1" *ngIf="imagesProgress[$i] != 100 && !failed">
                                                        <div class="col-sm-12 m-0 p-0">
                                                            <div class="progress-div" style="width: {{imagesProgress[$i]}}%;"></div>
                                                        </div>
                                                    </div>
                                                    <img src="{{imgPath}}" alt="{{imgPath}}" width="100" class="img-fluid img-center" [class.blur]="imagesProgress[$i] != 100" style="border-radius: 10px">
                                                </a>
                                                <div class="nt-center">
                                                    <div class="nt-circle add-button bg-dark" style="width: 20px; height: 20px" *ngIf="!failed">
                                                        <span class="fa fa-times small text-white"></span>
                                                    </div>
                                                    <div class="nt-circle add-button bg-dark" style="width: 20px; height: 20px" *ngIf="failed">
                                                        <span class="fa fa-refresh small text-white"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nt-center">
                                        <form #form enctype="multipart/form-data" class="">
                                            <div class="custom-upload">
                                                <input (change)="handleUpload(form, $event)" name="media_file" accept="image/*"
                                                       type="file">
                                                <!--<material-icon icon="add_circle" class="text-muted cursor-pointer" *ngIf="imgPath.isEmpty"></material-icon>-->
                                                <!--<div class="text-muted cursor-pointer text-center br-20" *ngIf="imgPaths.isEmpty" style="padding: 2rem; border: 1px dashed grey">Click to add <span class="fa fa-picture-o"></span></div>-->
                                                <div class="nt-circle bg-primary add-button">
                                                    <span class="fa fa-plus text-white"></span>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <!-- Panel 1 -->
                                <!-- Panel 2 -->
                                <div class="tab-pane fade position-relative" id="panel2" role="tabpanel">
                                    <div class="container p-2">
                                        <emoji-app (myClick)="setData($event)"></emoji-app>
                                    </div>
                                </div>
                                <!-- Panel 2 -->
                                <!-- Panel 3 -->
                                <div class="tab-pane fade" id="panel3" role="tabpanel">
                                    <div class="container mt-2 w-100">
                                        <form action="" novalidate>
                                            <div class="form-group">
                                                <input (keyup.enter)="addTag()" [(ngModel)]="hashtag"
                                                       class="nt-form-control br-20"
                                                       id="hash" placeholder="Hash tags ..."
                                                       type="text">
                                                <button (click)="addTag()"
                                                        [disabled]="hashtag.isEmpty || postMessage.isEmpty"
                                                        class="btn btn-primary btn-sm br-20"
                                                        id="tag_button"
                                                        type="button">
                                                    +
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="container mt-2 w-100">
                                        <div class="row">
                                            <material-chips>
                                                <material-chip (remove)="removeTag($i)"
                                                               *ngFor="let postTag of postTags; let $i = index"
                                                               [value]="postTag" class="col-auto">
                                                    {{postTag}}
                                                </material-chip>
                                            </material-chips>
                                        </div>
                                    </div>
                                </div>
                                <!-- Panel 3 -->
                            </div>


                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-sm-12 col-lg-7">
            <div class="card shadow-c bg-transparent {{appTheme['box-one']}} br-20 px-2 py-4 mb-3 c-bordered">
                <div class="card bg-transparent px-2 border-0 post-table br-20">
                    <div class="card-body">
                        <div class="row c-bordered box-three sticky-top">
                            <material-checkbox (click)="getAllIds()" [(checked)]="allIsChecked"></material-checkbox>
                            <material-button (click)="batchDelete()" [disabled]="deleteIds.isEmpty">
                                <material-icon icon="delete"></material-icon>
                            </material-button>
                            <div class="my-auto mx-3">
                                <span>{{deleteIds.length}}/{{currentPosts.length}}</span>
                            </div>
                        </div>

                        <div *ngIf="currentPosts.isNotEmpty" class="create-table-info">
                            <div *ngFor="let currentPost of currentPosts; let $i=index"
                                 class="row c-bordered {{appTheme['box-two']}} post-row">
                                <material-checkbox (click)="getId($i)"
                                                   [(checked)]="currentPost.checkedState"></material-checkbox>
                                <div class="mr-auto my-auto w-50 d-post-text">
                                    {{currentPost.postMessage}}
                                </div>
                                <div class="nt-circle light-button cursor-pointer mr-3 my-auto" (click)="editPost($i)">
                                    <span class="fa fa-edit font-weight-bold" *ngIf="editKeys[$i] == false"></span>
                                    <span class="fa fa-close font-weight-bold" *ngIf="editKeys[$i] == true"></span>
                                </div>
                                <material-icon icon="delete_outline" (click)="remove($i)" class="my-auto cursor-pointer mr-3"></material-icon>
                            </div>
                        </div>

                        <div *ngIf="currentPosts.isEmpty">
                            <div class="nt-center {{appTheme['text-muted']}}" style="width: max-content;">
                                <img src="img/no-data.png" alt="no-data" class="img-fluid mt-2" width="200">
                            </div>
                        </div>
                        <div *ngIf="loading">
                            <div class="nt-center {{appTheme['text-muted']}}">
                                <img src="img/load.gif" alt="Loading..." class="img-fluid" style="border-radius: 20px; background: rgba(255,255,255,0.95)">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

