<div class="col-4 py-2 mt-2 w-auto br-20 text-center"
     [class.alert-success]="postAlertCode==200"
     [class.alert-danger]="postAlertCode==500"
     *ngIf="postAlertBool" id="post_alert">
    <span class="fa fa-bell mx-3"></span>
    {{postAlert}}
    <span class="fa fa-times fa-sm mx-3 cursor-pointer"
          id="alert_close" (click)="dismissAlert()"></span>
</div>
<div class="row mt-3 ml-0 mr-0">
    <div class="col-lg-4 col-md-12 col-sm-12 mb-md-3 mb-0">
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-12">
                <div class="card shadow-c bg-transparent box-one br-20 border-0">
                    <div class="card-body">
                        <div class="text-center h6 text-muted">Create Schedule</div>
                        <form novalidate>
                            <div class="form-group">
                                <input type="text"
                                       class="nt-form-control border-0 br-20"
                                       placeholder="Schedule title" [(ngModel)]="title">
                            </div>
                            <!--<div class="form-group">
                                <material-date-range-picker class="simplified-example"
                                                            [(range)]="rangeSimplified"
                                                            [supportsComparison]="false"
                                                            [showNextPrevButtons]="false">
                                </material-date-range-picker>
                            </div>-->
                            <div class="form-group">
                                <input type="text" class="nt-form-control border-0 pr-5 br-20 datepicker alert-danger" placeholder="from" [(value)]="startDate" [class.alert-danger]="inputError">
                                <span class="fa fa-calendar float-right input-icon cursor-pointer"></span>
                                <material-datepicker [(date)]="startDate"
                                                     [minDate]="fromStart"
                                                     [maxDate]="fromEnd"
                                                     [required]="true"
                                                     class="dt-picker">
                                </material-datepicker>
                            </div>
                            <div class="form-group">
                                <input type="text" class="nt-form-control border-0 pr-5 br-20" placeholder="to" [(value)]="finalDate" [class.alert-danger]="inputError">
                                <span class="fa fa-calendar float-right input-icon cursor-pointer"></span>
                                <material-datepicker [(date)]="finalDate"
                                                     [minDate]="startDate"
                                                     [maxDate]="fromEnd"
                                                     [required]="true"
                                                     class="dt-picker">
                                </material-datepicker>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-12">
                <div class="card shadow-c bg-transparent box-one br-20 border-0 py-3 mt-3 my-3">
                    <div class="card bg-transparent br-20 border-0 mx-0" id="scheduled-posts">
                        <div class="card-body">
                            <div class="text-center h6 text-muted mb-3">Scheduled Posts</div>
                            <div *ngIf="scheduledPosts.isNotEmpty" class="px-3">
                                <div *ngFor="let scheduledPost of scheduledPosts; let $i = index" class="row py-1 bg-light br-20 mb-2">
                                    <div class="col-9">
                                <span class="text-muted d-post-text py-1">
                                    {{scheduledPost.title}}
                                </span>
                                    </div>
                                    <div class="col-3 my-auto text-right">
                                        <span class="fa fa-trash px-1 br-20 cursor-pointer" (click)="remove($i)" style="font-size: 12px !important;"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-5 text-muted text-center" *ngIf="scheduledPosts.isEmpty">
                                No schedule created
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-8 col-md-12 col-sm-12 mb-3">
        <div class="card shadow-c border-0 bg-transparent box-one br-20">
            <div class="card-body">
                <form novalidate #filterForm="ngForm" (ngSubmit)="onSubmit()" class="d-block d-md-none d-lg-none">
                    <material-expansionpanel-set flat>
                        <material-expansionpanel [showSaveCancel]="saveCancel">
                            <div name class="default-muted h6">
                                Select filters here
                                <span class="ml-2 text-primary">{{postIds.length}}/{{filteredPosts.length}}</span>
                            </div>
                            <div class="col-12 box-three m-0 br-20 py-1">
                                <select name="filter" id="filter" class="nt-form-control border-0 br-20" [(ngModel)]="selectedFilter">
                                    <option value="" disabled selected>Filter by:</option>
                                    <option [value]="filter" *ngFor="let filter of filters">{{filter}}</option>
                                </select>
                                <select name="number" id="number" class="nt-form-control border-0 br-20" [(ngModel)]="selectedNumber">
                                    <option value="" disabled selected>Show first:</option>
                                    <option [value]="number" *ngFor="let number of numbers">{{number}}</option>
                                </select>
                                <div class="row col-12 my-3">
                                    <div class="col-3 my-auto">
                                        <button type="button" class="btn btn-sm br-20 shadow-c"
                                                (click)="autoSync()">
                                            <span class="fa fa-sync" *ngIf="!isRefresh"></span>
                                            <div *ngIf="isRefresh">
                                                <img src="img/mini-loader.gif" style="width: 20px; height: auto">
                                            </div>
                                        </button>
                                    </div>
                                    <div class="col-9 my-auto">
                                        <button type="submit" class="btn btn-primary btn-block btn-sm br-20 px-3" [class.disabled]="selectedFilter.isEmpty">Fetch post</button>
                                    </div>
                                </div>
                            </div>
                        </material-expansionpanel>
                    </material-expansionpanel-set>
                </form>
                <form novalidate #filterForm="ngForm" (ngSubmit)="onSubmit()" class="d-none d-md-block d-lg-block">
                    <div class="row c-bordered box-three sticky-top mx-2 br-20">
                        <div class="col-auto mx-auto">
                            <select name="filter" id="filter" class="nt-form-control border-0 br-20" [(ngModel)]="selectedFilter">
                                <option value="" disabled selected>Filter by:</option>
                                <option [value]="filter" *ngFor="let filter of filters">{{filter}}</option>
                            </select>
                        </div>
                        <div class="col-auto mx-auto">
                            <select name="number" id="number" class="nt-form-control border-0 br-20" [(ngModel)]="selectedNumber">
                                <option value="" disabled selected>Show first:</option>
                                <option [value]="number" *ngFor="let number of numbers">{{number}}</option>
                            </select>
                        </div>
                        <div class="col-auto mx-auto my-auto">
                            <button type="submit" class="btn btn-primary btn-sm br-20 px-3" [class.disabled]="selectedFilter.isEmpty">Fetch post</button>
                        </div>
                        <div class="col-auto mx-auto my-auto">
                            <button type="button" class="btn btn-sm br-20 shadow-c"
                                    (click)="autoSync()">
                                <span class="fa fa-sync" *ngIf="!isRefresh"></span>
                                <div *ngIf="isRefresh">
                                    <img src="img/mini-loader.gif" style="width: 20px; height: auto">
                                </div>
                            </button>
                        </div>
                        <div class="col-auto mx-auto my-auto">
                            <span>{{postIds.length}}/{{filteredPosts.length}}</span>
                        </div>
                    </div>
                </form>
                <div class="row mt-2 mr-auto ml-auto" id="manage_box">
                    <div class="card border-0 box-one w-100 p-2 br-20" *ngIf="filteredPosts.isNotEmpty">
                        <div class="card-body">
                            <div class="row c-bordered box-three sticky-top">
                                <div class="col-2">
                                    <material-checkbox [(checked)]="allIsChecked" (click)="getAllIds()"></material-checkbox>
                                </div>
                                <div class="col-6 my-auto">
                                    <div class="text-muted">Post message</div>
                                </div>
                                <div class="col-4 my-auto">
                                    <div class="text-muted">Post tags</div>
                                </div>
                            </div>

                            <div class="row c-bordered box-two" *ngFor="let filteredPost of filteredPosts; let $i=index">
                                <div class="col-2">
                                    <material-checkbox class="my-0"
                                                       [(checked)]="filteredPost.checkedState" (click)="getId($i)">
                                    </material-checkbox>
                                </div>
                                <div class="d-post-text col-6">
                                    {{filteredPost.postMessage}}
                                </div>
                                <div class="col-4 d-post-text">
                                    <span class="tag" *ngFor="let tag of filteredPost.postTag">{{tag}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="filteredPosts.isEmpty && !loading">
                        <div class="nt-center text-muted" style="width: max-content;">
                            <span class="fa fa-cloud text-muted mr-1"></span>
                            {{emptyMessage}}
                            <button type="button" class="btn btn-sm btn-outline-primary br-20 ml-2" *ngIf="createNeed" [routerLink]="InnerRoutePaths.create_post.toUrl()">
                                <span class="fa fa-plus-circle mr-1"></span>Create post
                            </button>
                        </div>
                    </div>
                    <div *ngIf="filteredPosts.isEmpty && loading">
                        <div class="nt-center text-muted">
                            <img src="img/load.gif" alt="Loading..." class="img-fluid">
                        </div>
                    </div>
                </div>
                <div class="row col-lg-12 mx-0 mt-2 d-none d-lg-block d-md-block">
                    <div class="col-lg-6 col-md-6">
                        <input type="text" class="nt-form-control border-0 br-20" disabled [value]="title" placeholder="Title">
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <button class="btn btn-primary btn-sm btn-block btn-lg br-20 px-3"
                                type="button"
                                [class.disabled]="title.isEmpty || postIds.isEmpty"
                                (click)="postSchedule()">
                            <span *ngIf="!isPosting">Post Schedule</span>
                            <div *ngIf="isPosting">
                                <img src="img/mini-loader.gif" style="width: 20px; height: auto">
                            </div>
                        </button>
                    </div>
                </div>
                <div class="row col-md-12 mx-0 mt-2 d-block d-lg-none d-md-none">
                    <div class="col-md-6">
                        <input type="text" class="nt-form-control border-0 br-20" disabled [value]="title" placeholder="Title">
                    </div>
                    <div class="col-md-6">
                        <button class="btn btn-primary btn-sm btn-block btn-lg br-20 px-3"
                                type="button"
                                [class.disabled]="title.isEmpty || postIds.isEmpty"
                                (click)="postSchedule()">
                            <span class="fa fa-paper-plane" *ngIf="!isPosting"></span>
                            <div *ngIf="isPosting">
                                <img src="img/mini-loader.gif" style="width: 20px; height: auto">
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
